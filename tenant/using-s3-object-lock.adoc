---
permalink: tenant/using-s3-object-lock.html 
sidebar: sidebar 
keywords: how to use s3 object lock 
summary: 如果物件必須符合保留法規要求、您可以使用StorageGRID 支援功能的S3物件鎖定功能。 
---
= 使用S3物件鎖定搭配租戶使用
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果物件必須符合保留法規要求、您可以使用StorageGRID 支援功能的S3物件鎖定功能。



== 什麼是S3物件鎖定？

「物件鎖定」功能是物件保護解決方案、StorageGRID 相當於Amazon Simple Storage Service（Amazon S3）中的S3物件鎖定。

如圖所示、當啟用StorageGRID 全域S3物件鎖定設定以供支援某個功能時、S3租戶帳戶可以建立啟用或不啟用S3物件鎖定的儲存區。如果某個儲存區已啟用S3物件鎖定、則S3用戶端應用程式可選擇性地指定該儲存區中任何物件版本的保留設定。物件版本必須具有指定的保留設定、才能受到S3物件鎖定的保護。

image::../media/s3_object_lock_architecture.png[S3物件鎖定架構]

「S3物件鎖定」StorageGRID 功能提供單一保留模式、相當於Amazon S3法規遵循模式。依預設、受保護的物件版本無法由任何使用者覆寫或刪除。「S3物件鎖定」StorageGRID 功能不支援管理模式、也不允許具有特殊權限的使用者略過保留設定或刪除受保護的物件。

如果某個儲存區已啟用S3物件鎖定、則S3用戶端應用程式可在建立或更新物件時、選擇性地指定下列任一或兩個物件層級保留設定：

* *保留截止日期*：如果物件版本的保留截止日期在未來、則可擷取物件、但無法修改或刪除。視需要可增加物件的保留截止日期、但此日期不可減少。
* *合法持有*：將合法持有套用至物件版本、會立即鎖定該物件。例如、您可能需要對與調查或法律爭議相關的物件保留法律。合法持有沒有到期日、但在明確移除之前、仍會保留到位。合法持有不受保留至日期的限制。


您也可以 xref:../s3/operations-on-buckets.adoc#using-s3-object-lock-default-bucket-retention[指定儲存貯體的預設保留模式和預設保留期間]。這些物件會套用至新增至儲存區的每個物件、而這些物件並未指定其本身的保留設定。

如需這些設定的詳細資訊、請參閱 xref:../s3/using-s3-object-lock.adoc[使用S3物件鎖定]。



== 管理符合舊規範的儲存庫

S3物件鎖定功能取代先前StorageGRID 版本的Compliance功能。如果您使用StorageGRID 舊版的《不規則》建立了相容的儲存桶、您可以繼續管理這些儲存桶的設定、但是您無法再建立新的相容儲存桶。如需相關指示、請參閱NetApp知識庫文章。

https://["NetApp知識庫：如何管理StorageGRID 支援老舊的知識庫、請參閱《知識庫文章"^]



== S3物件鎖定工作流程

工作流程圖顯示StorageGRID 使用S3物件鎖定功能的高階步驟。

在啟用S3物件鎖定功能的情況下建立儲存區之前、網格管理員必須先為整個StorageGRID 支援整個系統啟用全域S3物件鎖定設定。網格管理員也必須確保 xref:../ilm/index.adoc[資訊生命週期管理（ILM）原則] 符合「合規」；必須符合啟用S3物件鎖定的貯體需求。如需詳細資料、請聯絡網格管理員、或參閱資訊生命週期管理的物件管理說明。

啟用全域S3物件鎖定設定之後、您可以建立啟用S3物件鎖定的儲存區。然後、您可以使用S3用戶端應用程式、選擇性地為每個物件版本指定保留設定。

image::../media/s3_object_lock_workflow_tenant.png[S3物件鎖定工作流程浮動授權]



== S3物件鎖定需求

在啟用儲存區的S3物件鎖定之前、請先檢閱S3物件鎖定儲存區和物件的需求、以及啟用S3物件鎖定之儲存區中物件的生命週期。



=== 啟用S3物件鎖定的儲存區需求

* 如果StorageGRID 已針對整個S3物件鎖定設定啟用for the S廳 系統、您可以使用租戶管理程式、租戶管理API或S3 REST API來建立啟用S3物件鎖定的儲存區。
+
此租戶管理程式範例顯示已啟用S3物件鎖定的儲存區。

+
image::../media/compliant_bucket.png[符合範例的工作時段]

* 如果您打算使用S3物件鎖定、則必須在建立儲存區時啟用S3物件鎖定。您無法為現有的儲存區啟用S3物件鎖定。
* S3物件鎖定需要庫位版本管理。當「S3物件鎖定」已啟用時、StorageGRID 即可自動啟用該儲存區的版本管理功能。
* 在建立啟用S3物件鎖定的儲存區之後、您無法停用該儲存區的S3物件鎖定或暫停版本管理。
* 您也可以設定儲存區的預設保留。上傳物件版本時、預設保留會套用至物件版本。您可以指定保留模式來覆寫儲存區預設值、並在上傳物件版本的要求中保留截止日期。
* S3物件生命週期儲存區支援儲存區生命週期組態。
* 啟用S3物件鎖定的儲存區不支援CloudMirror複寫。




=== 啟用S3物件鎖定之儲存區中的物件需求

* 為了保護物件版本、S3用戶端應用程式必須設定儲存區預設保留、或在每個上傳要求中指定保留設定。
* 您可以增加物件版本的保留截止日期、但絕不能減少此值。
* 如果您收到尚待處理的法律行動或法規調查通知、您可以在物件版本上保留合法資訊、以保留相關資訊。當物件版本處於合法持有狀態時、即使StorageGRID 物件已達到保留日期、也無法從該物件刪除。一旦取消合法持有、如果已達到保留截止日期、就可以刪除物件版本。
* S3物件鎖定需要使用版本控制的儲存區。保留設定適用於個別物件版本。物件版本可以同時具有「保留直到日期」和「合法保留」設定、但不能有另一個設定、或兩者都沒有。指定物件的保留截止日期或合法保留設定、只會保護要求中指定的版本。您可以建立物件的新版本、而舊版物件仍會保持鎖定狀態。




=== 啟用S3物件鎖定的儲存區物件生命週期

儲存在已啟用S3物件鎖定的儲存區中的每個物件都會經過三個階段：

. *物件擷取*
+
** 在啟用S3物件鎖定的儲存區中新增物件版本時、S3用戶端應用程式可選擇性地指定物件的保留設定（保留至日期、合法保留或兩者皆保留）。接著、將產生該物件的中繼資料、其中包括唯一的物件識別碼（UUID）和擷取日期與時間。StorageGRID
** 擷取具有保留設定的物件版本之後、就無法修改其資料和S3使用者定義的中繼資料。
** 不受物件資料限制、可獨立儲存物件中繼資料。StorageGRID它會在每個站台維護三份所有物件中繼資料複本。


. *物件保留*
+
** 物件的多個複本是StorageGRID 由NetApp儲存的。複本的確切數量和類型、以及儲存位置、取決於使用中ILM原則中的相容規則。


. *物件刪除*
+
** 物件到達保留截止日期時、即可刪除。
** 無法刪除合法持有的物件。



