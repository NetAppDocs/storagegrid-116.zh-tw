---
permalink: ilm/example-6-changing-ilm-policy.html 
sidebar: sidebar 
keywords: change ILM policy, example ILM policy, information lifecycle policy example 
summary: 如果您的資料保護需要變更或新增站台、可能需要建立並啟動新的ILM原則。 
---
= 範例6：變更ILM原則
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果您的資料保護需要變更或新增站台、可能需要建立並啟動新的ILM原則。

變更原則之前、您必須先瞭解ILM放置位置的變更如何暫時影響StorageGRID 到整個作業系統的效能。

在此範例中、StorageGRID 擴充中新增了一個全新的站台、需要修改作用中的ILM原則、以便將資料儲存在新站台。


CAUTION: 下列ILM規則和原則僅為範例。有許多方法可以設定ILM規則。在啟動新原則之前、請先模擬建議的原則、確認其運作方式符合保護內容免於遺失的目的。



== 變更ILM原則對效能有何影響

當您啟動新的ILM原則時、StorageGRID 可能會暫時影響到您的系統效能、尤其是新原則中的放置指示需要將許多現有物件移至新位置時。


CAUTION: 當您啟動新的ILM原則時StorageGRID 、利用它來管理所有物件、包括現有物件和新擷取的物件。在啟動新的ILM原則之前、請先檢閱現有複寫和銷毀編碼物件放置位置的任何變更。變更現有物件的位置、可能會在評估和實作新放置位置時、導致暫時性資源問題。

可能暫時影響StorageGRID 到性能不佳的ILM原則變更類型包括：

* 將不同的「刪除編碼」設定檔套用至現有的銷毀編碼物件。
+

NOTE: 支援使用新的設定檔時、將每個「刪除編碼」設定檔視為唯一、且不會重複使用銷毀編碼片段。StorageGRID

* 變更現有物件所需的複本類型；例如、將大量複寫物件轉換成銷毀編碼物件。
* 將現有物件的複本移至完全不同的位置、例如、將大量物件移入或移出Cloud Storage Pool、或移至或移出遠端站台。


xref:creating-ilm-policy.adoc[建立ILM原則]



== 範例6的Active ILM原則：兩個站台的資料保護

在此範例中、主動式ILM原則最初是針對雙站台StorageGRID 的作業系統而設計、並使用兩個ILM規則。

image::../media/policy_6_active_policy.png[ILM原則6作用中原則範例]

在此ILM原則中、屬於租戶A的物件在單一站台上受到2+1銷毀編碼的保護、而屬於所有其他租戶的物件則使用雙複製複寫在兩個站台上受到保護。


NOTE: 本範例中的第一條規則使用進階篩選器、以確保小型物件不會使用銷毀編碼。任何低於1 MB的租戶A物件、都會受到第二個規則的保護、後者會使用複寫功能。



=== 規則1：租戶A的單一站台銷毀編碼

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
租戶A的單一站台銷毀編碼



 a| 
租戶帳戶
 a| 
租戶A



 a| 
儲存資源池
 a| 
資料中心1.



 a| 
內容放置
 a| 
資料中心1的2+1銷毀編碼從第0天到永遠

|===


=== 規則2：為其他租戶進行雙站台複寫

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
其他租戶的雙站台複寫



 a| 
租戶帳戶
 a| 
忽略



 a| 
儲存資源池
 a| 
資料中心1和資料中心2



 a| 
內容放置
 a| 
從第0天到永遠複製兩份複本：一份複本在資料中心1、一份複本在資料中心2。

|===


== 建議的ILM原則、例如6：三個站台的資料保護

在此範例中、ILM原則正在更新三站台StorageGRID 的一套系統。

執行擴充以新增站台之後、網格管理員建立了兩個新的儲存集區：一個用於資料中心3的儲存集區、另一個儲存集區包含所有三個站台（與所有儲存節點預設儲存集區不同）。然後、系統管理員建立兩個新的ILM規則和一個新的ILM原則提案、其設計旨在保護所有三個站台的資料。

image::../media/policy_6_proposed_policy.png[ILM原則6建議原則範例]

啟動此新的ILM原則時、屬於租戶A的物件會在三個站台上受到2+1銷毀編碼的保護、屬於其他租戶（以及屬於租戶A的較小物件）的物件則會在三個站台上使用3個複製複寫來加以保護。



=== 規則1：租戶A的三站台銷毀編碼

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
租戶A的三站台銷毀編碼



 a| 
租戶帳戶
 a| 
租戶A



 a| 
儲存資源池
 a| 
所有3個資料中心（包括資料中心1、資料中心2和資料中心3）



 a| 
內容放置
 a| 
從第0天到第0天、所有3個資料中心都有2+1的銷毀編碼

|===


=== 規則2：其他租戶的三站台複寫

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
其他租戶的三站台複寫



 a| 
租戶帳戶
 a| 
忽略



 a| 
儲存資源池
 a| 
資料中心1、資料中心2和資料中心3



 a| 
內容放置
 a| 
從第0天到永遠複製三個複本：一個複本在資料中心1、一個複本在資料中心2、一個複本在資料中心3。

|===


== 啟動建議的ILM原則、例如6

當您啟動新的建議ILM原則時、現有物件可能會移至新位置、或根據任何新的或更新的規則中的放置指示、為現有物件建立新的物件複本。


CAUTION: ILM原則中的錯誤可能導致無法恢復的資料遺失。在啟動原則之前、請仔細檢閱並模擬原則、以確認其運作正常。


CAUTION: 當您啟動新的ILM原則時StorageGRID 、利用它來管理所有物件、包括現有物件和新擷取的物件。在啟動新的ILM原則之前、請先檢閱現有複寫和銷毀編碼物件放置位置的任何變更。變更現有物件的位置、可能會在評估和實作新放置位置時、導致暫時性資源問題。



=== 當銷毀編碼指令變更時會發生什麼事

在本範例目前使用中的ILM原則中、屬於租戶A的物件會在資料中心1使用2+1銷毀編碼加以保護。在新提議的ILM原則中、屬於租戶A的物件將在資料中心1、2和3上使用2+1銷毀編碼來保護。

啟動新的ILM原則時、會執行下列ILM作業：

* 租戶A擷取的新物件會分割成兩個資料分段、並新增一個同位元檢查分段。然後、這三個片段中的每一個都會儲存在不同的資料中心。
* 在進行中的ILM掃描程序中、會重新評估屬於租戶A的現有物件。由於ILM放置指示使用新的「刪除編碼」設定檔、因此會建立全新的銷毀編碼片段、並將其散佈至三個資料中心。
+

NOTE: 資料中心1上現有的2+1片段不會重複使用。支援使用新的設定檔時、將每個「刪除編碼」設定檔視為唯一、且不會重複使用銷毀編碼片段。StorageGRID





=== 複寫指示變更時會發生什麼事

在此範例中、目前作用中的ILM原則中、屬於其他租戶的物件會使用資料中心1和2儲存資源池中的兩個複寫複本來保護。在新提議的ILM原則中、屬於其他租戶的物件將使用資料中心1、2和3的儲存資源池中的三個複寫複本來保護。

啟動新的ILM原則時、會執行下列ILM作業：

* 當租戶以外的任何租戶擷取新物件時StorageGRID 、則會在每個資料中心建立三份複本、並儲存一份複本。
* 在進行中的ILM掃描程序中、會重新評估屬於這些其他租戶的現有物件。由於資料中心1和資料中心2的現有物件複本仍能滿足新ILM規則的複寫需求、StorageGRID 因此僅需為資料中心3建立一份物件的新複本。




=== 啟用此原則對效能的影響

當本範例中建議的ILM原則啟動時、StorageGRID 此VMware系統的整體效能將會暫時受到影響。若要為租戶A的現有物件建立新的銷毀編碼片段、以及在資料中心3為其他租戶現有物件建立新的複製複本、則需要比一般層級更高的網格資源。

由於ILM原則變更、用戶端讀取和寫入要求可能會暫時超過正常延遲時間。在整個網格中完全實作放置指示之後、延遲時間會恢復正常。

若要在啟動新的ILM原則時避免資源問題、您可以在任何可能變更大量現有物件位置的規則中使用「時間內擷取」進階篩選器。將「內嵌時間」設為大於或等於新原則生效的大約時間、以確保現有物件不會不必要地移動。


NOTE: 如果您需要減緩或提高ILM原則變更後處理物件的速度、請聯絡技術支援部門。
